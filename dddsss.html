// –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ —Å —É—á–µ—Ç–æ–º –≤–µ—Å–æ–≤
    function getRandomSymbol() {
        let totalWeight = symbols.reduce((sum, s) => sum + s.weight, 0);
        let random = Math.random() * totalWeight;
        
        for (let s of symbols) {
            if (random < s.weight) {
                return s.icon;
            }
            random -= s.weight;
        }
        return symbols[0].icon;
    }

    function spin() {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
        if (balance < bet) {
            statusDiv.textContent = "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!";
            statusDiv.className = "lose";
            spinBtn.disabled = true;
            return;
        }

        // –°–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
        balance -= bet;
        updateUI();
        
        // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
        spinBtn.disabled = true;
        statusDiv.textContent = "–ö—Ä—É—Ç–∏–º...";
        statusDiv.className = "";

        let spins = 0;
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ (–º–µ–Ω—è–µ–º —Å–∏–º–≤–æ–ª—ã –±—ã—Å—Ç—Ä–æ 20 —Ä–∞–∑)
        let interval = setInterval(() => {
            slots.forEach(slot => slot.textContent = getRandomSymbol());
            spins++;

            // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
            if (spins > 20) {
                clearInterval(interval);
                finalizeSpin();
            }
        }, 100);
    }

    function finalizeSpin() {
        // –ó–¥–µ—Å—å –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        const result1 = getRandomSymbol();
        const result2 = getRandomSymbol();
        const result3 = getRandomSymbol();

        slots[0].textContent = result1;
        slots[1].textContent = result2;
        slots[2].textContent = result3;

        checkWin(result1, result2, result3);
        
        spinBtn.disabled = false;
        
        // –ï—Å–ª–∏ –±–∞–ª–∞–Ω—Å 0 –ø–æ—Å–ª–µ –ø—Ä–æ–∏–≥—Ä—ã—à–∞ - –±–ª–æ–∫–∏—Ä—É–µ–º –Ω–∞–≤—Å–µ–≥–¥–∞
        if (balance < bet) {
            spinBtn.disabled = true;
            spinBtn.textContent = "GAME OVER";
            spinBtn.style.backgroundColor = "#95a5a6";
        }
    }

    function checkWin(s1, s2, s3) {
        // –õ–û–ì–ò–ö–ê –í–´–ò–ì–†–´–®–ê
        
        // 1. –î–∂–µ–∫–ø–æ—Ç: 777 (+1000)
        if (s1 === '7Ô∏è‚É£' && s2 === '7Ô∏è‚É£' && s3 === '7Ô∏è‚É£') {
            balance += 1000;
            statusDiv.textContent = "–î–ñ–ï–ö–ü–û–¢! +1000 üí∞";
            statusDiv.className = "jackpot";
        }
        // 2. –î–µ–Ω—å–≥–∏: üíµüíµüíµ (+100)
        else if (s1 === 'üíµ' && s2 === 'üíµ' && s3 === 'üíµ') {
            balance += 100;
            statusDiv.textContent = "–í—ã–∏–≥—Ä—ã—à! +100 üí∞";
            statusDiv.className = "win";
        }
        // 3. –ó–≤–µ–∑–¥—ã: ‚≠ê‚≠ê‚≠ê (–ù–∏—á–µ–≥–æ, –∫–∞–∫ —Ç—ã –ø—Ä–æ—Å–∏–ª)
        else if (s1 === '‚≠ê' && s2 === '‚≠ê' && s3 === '‚≠ê') {
            statusDiv.textContent = "–¢—Ä–∏ –∑–≤–µ–∑–¥—ã... –ü—É—Å—Ç–æ!";
            statusDiv.className = "lose";
        }
        // 4. –õ—é–±–∞—è –¥—Ä—É–≥–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è
        else {
            statusDiv.textContent = "–ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑";
            statusDiv.className = "lose";
        }
        
        updateUI();
    }

    function updateUI() {
        balanceSpan.textContent = balance;
    }
</script>

</body>
</html>
